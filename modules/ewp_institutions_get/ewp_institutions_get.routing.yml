# Parent admin route
ewp_institutions_get.admin:
  path: '/admin/ewp/hei/get'
  defaults:
    _controller: '\Drupal\system\Controller\SystemController::systemAdminMenuBlockPage'
    _title: 'EWP Institutions GET'
  requirements:
    _permission: 'administer institution entities'

# Settings form
ewp_institutions_get.settings:
  path: '/admin/ewp/hei/get/settings'
  defaults:
    _form: '\Drupal\ewp_institutions_get\Form\SettingsForm'
    _title: 'Settings'
  requirements:
    _permission: 'administer institution entities'

# Field mapping form
ewp_institutions_get.mapping:
  path: '/admin/ewp/hei/get/settings/mapping'
  defaults:
    _form: '\Drupal\ewp_institutions_get\Form\FieldMappingForm'
    _title: 'Field mapping'
  requirements:
    _permission: 'administer institution entities'

# Field mapping form
ewp_institutions_get.field_settings:
  path: '/admin/ewp/hei/get/settings/fields'
  defaults:
    _form: '\Drupal\ewp_institutions_get\Form\FieldSettingsForm'
    _title: 'Field settings'
  requirements:
    _permission: 'administer institution entities'

# Pre-load form
ewp_institutions_get.preload:
  path: '/admin/ewp/hei/get/preload'
  defaults:
    _form: '\Drupal\ewp_institutions_get\Form\PreLoadForm'
    _title: 'Pre-load'
  requirements:
    _permission: 'administer institution entities'

# Preview form
ewp_institutions_get.preview:
  path: '/admin/ewp/hei/get/preview'
  defaults:
    _form: '\Drupal\ewp_institutions_get\Form\PreviewForm'
    _title: 'Preview'
  requirements:
    _permission: 'administer institution entities'

# Import entity form
entity.hei.import_form:
  path: '/ewp/hei/import/{index_key}/{hei_key}'
  defaults:
      _entity_form: hei.import
      entity_type_id: hei
      _title_callback: 'Drupal\Core\Entity\Controller\EntityController::addTitle'
      index_key: 'EU'
      hei_key: 'example.edu'
  requirements:
    _entity_create_access: hei
    # RegEx for EWP ASCII Printable Identifier is too permissive
    index_key: '[A-Za-z0–9_-]+'
    # RegEx for a valid domain name, as expected in HEI IDs
    hei_key: '(?=.{4,255}$)((?!-)[A-Za-z0–9-]{1,63}(?<!-)\.)+[A-Za-z]{2,24}'
  options:
    _admin_route: true
    parameters:
      index_key:
        type: index_key
      hei_key:
        type: hei_key

# Update entity form
entity.hei.update_form:
  path: '/ewp/hei/{hei}/update'
  defaults:
      _entity_form: hei.update
      entity_type_id: hei
      _title_callback: 'Drupal\Core\Entity\Controller\EntityController::editTitle'
  requirements:
    _entity_access: hei.update
    hei: '\d+'
  options:
    _admin_route: true
    parameters:
      hei:
        type: entity:hei
